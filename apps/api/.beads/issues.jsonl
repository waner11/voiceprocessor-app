{"id":"voiceprocessor-api-0eq","title":"Setup database context and migrations","description":"Setup VoiceProcessorDbContext with EF Core and PostgreSQL. Configure entity relationships, indexes, and create initial migration.","notes":"Completed: DbContext in Accessors/Data/DbContext/. Tables: users, voices, generations, generation_chunks, feedbacks. Migration applied to local PostgreSQL (podman container).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-18T12:22:00.956204863-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:25:54.113077204-05:00","closed_at":"2026-01-18T12:25:56.485321982-05:00","close_reason":"DbContext, migrations, and DI registration complete"}
{"id":"voiceprocessor-api-0j2","title":"Implement TTS audio generation and chunk processing","description":"Implement the actual TTS generation workflow. Includes: background job that processes generation, calls TTS provider accessor for each chunk, handles retries/failures, updates generation status and progress. Depends on Hangfire setup.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-19T17:15:24.977265713-05:00","created_by":"wanerpena","updated_at":"2026-01-19T21:02:22.782348857-05:00","closed_at":"2026-01-19T21:02:22.782348857-05:00","close_reason":"Implemented TTS generation with chunk processing, retry logic, progress tracking, and error handling","dependencies":[{"issue_id":"voiceprocessor-api-0j2","depends_on_id":"voiceprocessor-api-upe","type":"blocks","created_at":"2026-01-19T17:15:59.184680677-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-141","title":"Integrate payment history in billing settings","description":"## Frontend: Payment History Integration\n\nConnect the payment history table in billing settings to the backend API.\n\n### Backend Endpoint (Ready)\n`GET /api/v1/payments/history` - Returns user's payment history\n\n### API Response Example\n```json\n{\n  \"payments\": [\n    {\n      \"id\": \"uuid\",\n      \"packName\": \"Starter Pack\",\n      \"creditsAdded\": 10000,\n      \"amountPaid\": 9.99,\n      \"currency\": \"usd\",\n      \"status\": \"completed\",\n      \"createdAt\": \"2026-01-24T12:00:00Z\"\n    }\n  ]\n}\n```\n\n### Implementation\n1. Call API on billing page load\n2. Populate existing payment history table\n3. Format dates and currency properly\n4. Handle empty state (no payments yet)\n\n### Acceptance Criteria\n- [ ] Payment history fetched from API\n- [ ] Table displays date, pack, amount, status\n- [ ] Empty state shown for new users\n- [ ] Loading skeleton during fetch","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-24T19:55:46.559197585-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:56:17.366316625-05:00"}
{"id":"voiceprocessor-api-1mm","title":"Implement FeedbackAccessor for generation ratings","description":"Create FeedbackAccessor to persist user feedback. Includes: IFeedbackAccessor interface, FeedbackAccessor implementation, wire up in GenerationManager.SubmitFeedbackAsync (line 242 has TODO). Feedback entity already exists.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:15:39.982275032-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:15:39.982275032-05:00"}
{"id":"voiceprocessor-api-1sc","title":"Auto-refresh credits after successful payment","description":"## Frontend: Auto-refresh Credits After Payment\n\nEnsure user credits are updated immediately after successful Stripe payment.\n\n### Problem\nAfter Stripe checkout, user redirects to success page but may see stale credit balance until page refresh.\n\n### Solution\n1. On success page mount, fetch updated user profile\n2. Update global credits state\n3. Show toast notification confirming credits added\n\n### Implementation\n1. Call `GET /api/v1/auth/me` or user endpoint to get fresh credits\n2. Update user context/store with new `creditsRemaining`\n3. Display toast: 'Added 10,000 credits to your account'\n4. Dashboard should reflect new balance without refresh\n\n### Technical Notes\n- Webhook processing adds credits before user redirects\n- Success page should always show updated credits\n- Consider using React Query invalidation or similar\n\n### Acceptance Criteria\n- [ ] Credits refresh on success page\n- [ ] Dashboard shows updated balance\n- [ ] Toast notification confirms purchase\n- [ ] No manual refresh needed","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-24T19:55:46.896920981-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:56:26.857788953-05:00","dependencies":[{"issue_id":"voiceprocessor-api-1sc","depends_on_id":"voiceprocessor-api-ytz","type":"blocks","created_at":"2026-01-24T19:56:36.053038886-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-2fo","title":"Implement Domain entities","description":"Create domain entities: User, Voice, Generation, GenerationChunk, Feedback. Create enums: GenerationStatus, ChunkStatus, Provider, RoutingPreference, SubscriptionTier.","notes":"Completed: All entities in Domain/Entities/, enums in Domain/Enums/. Entities have navigation properties for EF Core relationships.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-18T12:16:37.862114578-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:25:51.681062008-05:00","closed_at":"2026-01-18T12:19:47.840177009-05:00","close_reason":"Created all domain entities and enums"}
{"id":"voiceprocessor-api-2r4","title":"Create Manager interfaces","description":"Define Manager layer interfaces following iDesign: IGenerationManager, IVoiceManager, IUserManager. Managers orchestrate between Controllers and Engines/Accessors.","notes":"Completed: Interfaces in Managers/Contracts/. NOT YET IMPLEMENTED - need implementations and DI registration.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T13:37:47.835307796-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:26:12.825067618-05:00","closed_at":"2026-01-18T13:39:19.316139582-05:00","close_reason":"Manager interfaces created: IGenerationManager, IVoiceManager, IUserManager"}
{"id":"voiceprocessor-api-2yp","title":"Implement chapter detection using pattern matching","description":"Detect chapter boundaries in text using regex patterns.\n\n**Approach:** Pattern matching (MVP decision - fast, handles 80% of books)\n\n**Patterns to Detect:**\n- Chapter 1, Chapter 23, CHAPTER I, Ch. 1\n- Part 1, Part I, PART ONE\n- Prologue, Epilogue, Introduction, Foreword, Afterword\n- Section 1, Book 1\n- Bare numbers: '1.', 'XIV'\n- Dividers: ***, ---, ===\n\n**Implementation:**\n1. Create ChapterDetectionEngine in Engines layer\n2. Add IChapterDetectionEngine interface\n3. Implement regex-based detection\n4. Return list of chapters with titles and character offsets\n\n**Output Schema:**\n```csharp\npublic record DetectedChapter\n{\n    public int ChapterNumber { get; init; }\n    public string Title { get; init; }\n    public int CharacterOffset { get; init; }\n    public int EstimatedWordCount { get; init; }\n}\n```\n\n**References:**\n- TECHNICAL_DESIGN.md section on chunking strategies\n- Librarian research bg_eda576d0 for regex patterns\n\n**Future Enhancement (not MVP):**\n- AI-powered detection for books without explicit markers\n- PDF/DOCX heading extraction","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-24T19:49:35.03265073-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:49:35.03265073-05:00"}
{"id":"voiceprocessor-api-33n","title":"Implement Accessor classes","description":"Implement Accessor classes: database accessors (EF Core), TTS provider accessors (ElevenLabs, OpenAI with IHttpClientFactory + Polly), LocalStorageAccessor, TtsProviderFactory.","notes":"Completed: All accessors implemented and registered via AddAccessors() extension in Program.cs. Includes retry policies, circuit breaker, shared AccessorJsonOptions.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T13:54:21.098724325-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:26:29.934062295-05:00","closed_at":"2026-01-18T13:57:46.506963997-05:00","close_reason":"Accessor implementations: database (User, Voice, Generation, Chunk), TTS providers (ElevenLabs, OpenAI), storage"}
{"id":"voiceprocessor-api-38d","title":"Implement Engine classes","description":"Implement IRoutingEngine (provider selection based on cost/quality/speed), IChunkingEngine (text splitting preserving boundaries), IPricingEngine (cost calculation). Engines contain stateless business logic, called by Managers.","notes":"Completed: All engines implemented following iDesign (no Accessor dependencies). ChunkingEngine splits text preserving word/sentence/paragraph boundaries. PricingEngine calculates costs with configurable provider rates. RoutingEngine scores providers by cost/speed/quality based on preference. All registered via AddEngines() in Program.cs.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T14:30:26.741090635-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:34:18.51029425-05:00","closed_at":"2026-01-18T14:34:08.871786288-05:00","close_reason":"Implemented ChunkingEngine, PricingEngine, RoutingEngine with DI registration"}
{"id":"voiceprocessor-api-3h0","title":"Add Stripe configuration","description":"Add Stripe section to appsettings.json and appsettings.Development.json with SecretKey and WebhookSecret placeholders.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-23T22:57:02.516226318-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:01:31.433748257-05:00","closed_at":"2026-01-23T23:01:31.433748257-05:00","close_reason":"Added Stripe section to appsettings.json and appsettings.Development.json, created StripeOptions class with SecretKey and WebhookSecret"}
{"id":"voiceprocessor-api-565","title":"Implement StripeAccessor","description":"Create IStripeAccessor interface and StripeAccessor implementation. Methods: GetCreditPacksAsync (fetch from Stripe, cache 1hr), CreateCheckoutSessionAsync, ParseWebhookAsync. Add StripeOptions config class.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:55.822318446-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:02:50.775533346-05:00","closed_at":"2026-01-23T23:02:50.775533346-05:00","close_reason":"Created IStripeAccessor interface and StripeAccessor implementation with GetCreditPacksAsync (cached), CreateCheckoutSessionAsync, and ParseWebhook methods. Added Stripe.net NuGet package."}
{"id":"voiceprocessor-api-5b9","title":"Implement credits deduction on generation","description":"Deduct user credits after successful generation. Includes: update UserAccessor with DeductCreditsAsync, call after generation completes, handle edge cases (partial completion, cancellation). Credit check already exists in GenerationManager.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-19T17:15:37.835699148-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:45:04.64819183-05:00","closed_at":"2026-01-23T23:45:04.64819183-05:00","close_reason":"Already implemented - DeductCreditsAsync exists in UserAccessor and is called in GenerationProcessor after successful generation"}
{"id":"voiceprocessor-api-6cc","title":"Implement audio merging for multi-chunk generations","description":"Implement AudioMergeEngine to combine audio chunks into final file. Includes: NAudio integration for audio processing, chunk ordering, format normalization, upload merged file to storage, update generation with final audioUrl.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-19T17:15:29.409473393-05:00","created_by":"wanerpena","updated_at":"2026-01-19T21:05:09.903803425-05:00","closed_at":"2026-01-19T21:05:09.903803425-05:00","close_reason":"Implemented AudioMergeEngine with NAudio for proper MP3 merging","dependencies":[{"issue_id":"voiceprocessor-api-6cc","depends_on_id":"voiceprocessor-api-0j2","type":"blocks","created_at":"2026-01-19T17:15:59.218231831-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-7d4","title":"Create Engine interfaces","description":"Define Engine layer interfaces following iDesign: IRoutingEngine (provider selection), IChunkingEngine (text splitting), IPricingEngine (cost calculation). Engines handle algorithmic business logic.","notes":"Completed: Interfaces in Engines/Contracts/ with supporting records (RoutingContext, TextChunk, PriceEstimate, etc.). NOT YET IMPLEMENTED - need implementations and DI registration.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T13:42:00.692904767-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:26:24.863827633-05:00","closed_at":"2026-01-18T13:43:09.759622259-05:00","close_reason":"Engine interfaces created: IRoutingEngine, IChunkingEngine, IPricingEngine"}
{"id":"voiceprocessor-api-7qe","title":"Document upload (PDF/DOCX to text extraction for TTS)","description":"Allow users to upload PDF/DOCX files for automatic text extraction before TTS generation. Enables '1 click audiobook' workflow.\n\n**Target Phase:** Beta (Mar 2026)\n\n**Research Summary:**\n- File formats: PDF (PdfPig), DOCX (OpenXml), TXT\n- Max file size: 50 MB\n- Libraries: UglyToad.PdfPig (Apache 2.0), DocumentFormat.OpenXml (MIT)\n- ASP.NET config: MaxRequestBodySize=50MB, MultipartBodyLengthLimit=50MB\n- Security: Extension allowlist, magic byte validation, safe filenames\n- Effort: 2-3 days\n\n**Business Value:** High - directly enables indie author use case and reduces friction for long-form content.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-24T18:34:41.100808971-05:00","created_by":"wanerpena","updated_at":"2026-01-24T18:34:48.587949457-05:00","dependencies":[{"issue_id":"voiceprocessor-api-7qe","depends_on_id":"voiceprocessor-api-yqy","type":"discovered-from","created_at":"2026-01-24T18:58:13.716896339-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-7x5","title":"Create API Controllers","description":"Create API controllers: ApiControllerBase, GenerationsController, VoicesController. Configure Swagger/OpenAPI with Swashbuckle.","notes":"Completed: Controllers return stub data with TODO comments for manager integration. Swagger UI at root in development. XML docs enabled for API documentation.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-18T12:44:16.009707373-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:26:09.977686754-05:00","closed_at":"2026-01-18T12:50:07.581880452-05:00","close_reason":"API controllers implemented with Swagger UI"}
{"id":"voiceprocessor-api-7zu","title":"Add voice parameter presets for content types","description":"Replace hardcoded ElevenLabs voice settings with content-based presets.\n\n**Current State:**\n- ElevenLabsAccessor.cs uses hardcoded: stability=0.5, similarity=0.75, style=0, speakerBoost=true\n- OpenAI only passes speed (default 1.0)\n\n**Presets to Implement (research-based):**\n\n| Preset | Stability | Similarity | Speed | Best For |\n|--------|-----------|------------|-------|----------|\n| audiobook (default) | 0.70 | 0.80 | 1.0 | Long-form narration |\n| conversational | 0.50 | 0.75 | 1.05 | Podcasts, casual |\n| dramatic | 0.35 | 0.70 | 0.95 | Fiction, emotional |\n| professional | 0.80 | 0.85 | 1.0 | Technical, educational |\n\n**Source of Values:**\n- ElevenLabs official documentation\n- Librarian research (bg_cf2ddc74) on content-type recommendations\n- NOT validated by manual testing - use as starting point\n\n**Validation Strategy:**\n- Use research values for MVP\n- Add A/B testing later to optimize (separate issue)\n- Track user feedback to correlate preset with satisfaction\n\n**Implementation:**\n1. Add VoicePreset enum to Domain\n2. Add preset field to CreateGenerationRequest\n3. Create preset-to-settings mapping in Engine layer\n4. Update ElevenLabsAccessor to use mapped settings\n5. Update OpenAI to apply speed from preset\n\n**API Changes:**\n- POST /api/v1/generations accepts optional 'preset' field\n- Default preset: 'audiobook'\n\n**Frontend:**\n- Add dropdown to generation form (separate issue in voiceprocessor-web)","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-24T19:22:12.599683684-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:25:16.225517866-05:00"}
{"id":"voiceprocessor-api-8qr","title":"Add user profile management endpoints","description":"Add endpoints for user self-service. Includes: update profile (name), change password, set password for OAuth-only users, delete account. Extend AuthController or create UserController.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T17:15:46.999710489-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:15:46.999710489-05:00"}
{"id":"voiceprocessor-api-9bv","title":"Integrate Stripe checkout for credit pack purchases","description":"## Frontend: Stripe Checkout Integration\n\nConnect the billing page to backend Stripe endpoints to enable credit pack purchases.\n\n### Backend Endpoints (Ready \u0026 Tested)\n- `GET /api/v1/payments/packs` - Returns available credit packs with prices\n- `POST /api/v1/payments/checkout` - Creates Stripe checkout session, returns `checkoutUrl`\n\n### Implementation Steps\n1. Fetch credit packs from API on billing page load\n2. Display packs with name, credits, and price\n3. On 'Buy' click, call checkout endpoint with `priceId`\n4. Redirect user to returned `checkoutUrl`\n\n### API Response Examples\n```json\n// GET /api/v1/payments/packs\n{\n  \"packs\": [\n    { \"priceId\": \"price_xxx\", \"name\": \"Starter Pack\", \"credits\": 10000, \"priceAmount\": 9.99 },\n    { \"priceId\": \"price_yyy\", \"name\": \"Pro Pack\", \"credits\": 50000, \"priceAmount\": 39.99 }\n  ]\n}\n\n// POST /api/v1/payments/checkout\n{\n  \"checkoutUrl\": \"https://checkout.stripe.com/...\",\n  \"sessionId\": \"cs_test_...\"\n}\n```\n\n### Acceptance Criteria\n- [ ] Credit packs displayed on billing page\n- [ ] Buy button triggers checkout flow\n- [ ] User redirected to Stripe checkout\n- [ ] Loading states during API calls\n- [ ] Error handling for failed requests","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-24T19:55:45.883112389-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:55:59.913245198-05:00"}
{"id":"voiceprocessor-api-9n7","title":"Integrate Stripe for payments and billing","description":"Implement Stripe integration for subscription billing and usage-based payments. Includes: Stripe SDK setup, subscription tiers (Free/Pro/Enterprise), webhook handling for payment events, customer portal integration, usage metering for TTS credits, invoice generation.","status":"closed","priority":0,"issue_type":"feature","created_at":"2026-01-19T17:11:40.891383368-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:44:48.252757833-05:00","closed_at":"2026-01-23T23:44:48.252757833-05:00","close_reason":"Completed Stripe integration with credit packs, checkout sessions, webhooks, and payment history"}
{"id":"voiceprocessor-api-ag0","title":"Test Stripe integration with Stripe CLI","description":"End-to-end testing: create Stripe test products with credits metadata, test checkout flow, use stripe listen --forward-to for webhook testing, verify credits added correctly.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-23T22:57:03.158591155-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:42:45.648413446-05:00","closed_at":"2026-01-24T19:42:45.648413446-05:00","close_reason":"All Stripe integration tests passed: checkout flow, webhooks, credits, idempotency, error handling verified"}
{"id":"voiceprocessor-api-ai5","title":"Integrate PostHog for feature flags and analytics","description":"Add PostHog SDK to both backend (.NET) and frontend (React). Covers: feature flag implementation, user identification across platforms, event tracking for key actions (generation started, completed, etc.), session recordings setup. User already has PostHog account.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:11:26.60220834-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:11:26.60220834-05:00"}
{"id":"voiceprocessor-api-b3y","title":"Seed voice catalog from TTS providers","description":"Populate voices table from ElevenLabs and OpenAI. Includes: fetch voices from provider APIs on startup or via refresh endpoint, map to Voice entity with provider metadata (language, gender, preview URL, cost). Required for testing generation flow.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-19T17:15:34.366156455-05:00","created_by":"wanerpena","updated_at":"2026-01-19T20:21:38.502829229-05:00","closed_at":"2026-01-19T20:21:38.502829229-05:00","close_reason":"Voice seeding was already implemented. Added VoiceSeedingService hosted service for auto-seed on startup when voices table is empty."}
{"id":"voiceprocessor-api-bcw","title":"Implement PaymentHistoryAccessor","description":"Create IPaymentHistoryAccessor interface and implementation. Methods: GetByStripeSessionIdAsync, CreateAsync, GetByUserIdAsync. Use for idempotent webhook handling.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:56.780481047-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:03:27.505850028-05:00","closed_at":"2026-01-23T23:03:27.505850028-05:00","close_reason":"Created IPaymentHistoryAccessor interface and PaymentHistoryAccessor implementation with GetByStripeSessionIdAsync, CreateAsync, GetByUserIdAsync methods"}
{"id":"voiceprocessor-api-bss","title":"Add SignalR for real-time generation progress","description":"Implement SignalR hub for generation progress updates. Includes: GenerationHub setup, notify clients on status changes (pending→processing→completed), progress percentage updates, error notifications. Improves UX over polling.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:15:42.140834891-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:15:42.140834891-05:00"}
{"id":"voiceprocessor-api-buu","title":"Set up unit and integration tests","description":"Create test projects for key components. Includes: VoiceProcessor.Managers.Tests, VoiceProcessor.Engines.Tests, test coverage for AuthManager, GenerationManager, ChunkingEngine, PricingEngine. Use xUnit + Moq + FluentAssertions.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-19T17:15:49.438017977-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:15:49.438017977-05:00"}
{"id":"voiceprocessor-api-cs3","title":"Implement Manager classes","description":"Implement IGenerationManager (TTS workflow orchestration), IVoiceManager (voice catalog), IUserManager (credits/activity). Managers coordinate between Controllers and Engines/Accessors following iDesign calling rules.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T14:36:12.568511772-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:40:45.31281369-05:00","closed_at":"2026-01-18T14:40:45.31281369-05:00","close_reason":"Implemented all three Manager classes (UserManager, VoiceManager, GenerationManager) with full business logic orchestration. Fixed namespace conflicts (User entity vs User namespace) and added missing ITtsProviderFactory reference. Created DI extension and wired up AddManagers() in Program.cs. Build verified successful."}
{"id":"voiceprocessor-api-cyy","title":"Add chapter markers to audio output (M4B + MP3 options)","description":"Embed chapter metadata in generated audiobooks and support per-chapter MP3 export.\n\n**Output Options (user choice):**\n1. **M4B with chapters** - Single file with QuickTime chapter atoms (Apple Books, Audible-like)\n2. **MP3 per chapter** - Separate files for each chapter (universal compatibility)\n\n**Technical Implementation:**\n\n**M4B Chapters:**\n- Use FFmpeg or TagLibSharp to embed chapter metadata\n- Format: QuickTime chapter atoms\n- Metadata: title, start time, end time per chapter\n\n**FFmpeg metadata format:**\n```\n;FFMETADATA1\n[CHAPTER]\nTIMEBASE=1/1000\nSTART=0\nEND=300000\ntitle=Chapter 1: Introduction\n```\n\n**MP3 Per Chapter:**\n- Generate separate audio files per chapter\n- Naming convention: `{book-title}-ch01-{chapter-title}.mp3`\n- Option to also create a ZIP archive\n\n**Libraries:**\n- TagLibSharp (NuGet) - for chapter metadata\n- FFMpegCore (NuGet) - FFmpeg wrapper for .NET\n- FFmpeg - for audio concatenation and metadata\n\n**Database:**\nAdd Chapters table to track chapter timing:\n```sql\nCREATE TABLE Chapters (\n    Id UUID PRIMARY KEY,\n    GenerationId UUID REFERENCES Generations,\n    ChapterNumber INT,\n    Title VARCHAR(500),\n    StartTimeMs BIGINT,\n    EndTimeMs BIGINT,\n    CharacterOffset INT\n);\n```\n\n**API Changes:**\n- Add output_format to CreateGenerationRequest: 'm4b_chaptered' | 'mp3_per_chapter' | 'mp3_single'\n- Add /api/v1/generations/{id}/chapters endpoint\n\n**Depends on:** voiceprocessor-api-2yp (chapter detection)","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-24T19:49:51.575919077-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:49:51.575919077-05:00","dependencies":[{"issue_id":"voiceprocessor-api-cyy","depends_on_id":"voiceprocessor-api-2yp","type":"blocks","created_at":"2026-01-24T19:49:57.726910473-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-d5g","title":"Add Google and GitHub OAuth Login","description":"Add Google and GitHub OAuth social login to VoiceProcessor API. Users can register/login via OAuth, and existing accounts are auto-linked when emails match. Endpoints: GET /oauth/{provider}/url, POST /oauth/{provider}/callback, GET/POST/DELETE for linking providers.","notes":"Implementation plan: Add OAuth social login with Google and GitHub providers. Auto-links accounts when emails match existing users. Follows iDesign architecture with OAuth engines, ExternalLogin accessor, and extended AuthManager.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T17:58:33.06678289-05:00","created_by":"wanerpena","updated_at":"2026-01-18T18:09:14.131249339-05:00","closed_at":"2026-01-18T18:09:14.131249339-05:00","close_reason":"Google and GitHub OAuth implementation complete - all 7 phases done, build passes"}
{"id":"voiceprocessor-api-dhj","title":"Create WebhooksController","description":"Create WebhooksController for POST /webhooks/stripe. Verify Stripe signature, handle checkout.session.completed event, add credits idempotently, log to PaymentHistory.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:57:00.509217636-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:07:52.958454722-05:00","closed_at":"2026-01-23T23:07:52.958454722-05:00","close_reason":"Created WebhooksController with POST /webhooks/stripe endpoint. Reads raw body, verifies Stripe signature, delegates to PaymentManager for idempotent processing."}
{"id":"voiceprocessor-api-dl6","title":"Create Stripe DTOs","description":"Create request/response DTOs: CreateCheckoutRequest (priceId, successUrl, cancelUrl), CheckoutResponse (checkoutUrl), CreditPackDto (priceId, name, credits, priceUsd, currency), CreditPacksResponse.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:54.88407268-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:00:29.811643955-05:00","closed_at":"2026-01-23T23:00:29.811643955-05:00","close_reason":"Created all Stripe DTOs: CreateCheckoutRequest, CheckoutResponse, CreditPackResponse, CreditPacksResponse, PaymentHistoryResponse, PaymentHistoryListResponse"}
{"id":"voiceprocessor-api-gf8","title":"Implement JWT + API Key Authentication","description":"Implement dual authentication: JWT for user sessions (15min access, 7-day refresh tokens) and API Keys for programmatic access (vp_ prefix, hashed storage). Both auth methods work on same endpoints. Includes registration, login, token refresh, logout, and API key management endpoints.","notes":"## Implementation Plan\n\n**Architecture (iDesign layers):**\n- Engines: JwtEngine, PasswordEngine, ApiKeyEngine (stateless crypto/token ops)\n- Managers: AuthManager (business logic, orchestration)\n- Accessors: RefreshTokenAccessor, ApiKeyAccessor (data access)\n- Clients.Api: Auth handlers, AuthController, CurrentUserService\n\n**New Entities:**\n- RefreshToken: token rotation, device tracking, expiry\n- ApiKey: vp_ prefix, SHA256 hashed, expiry support\n\n**User Entity Updates:**\n- PasswordHash, PasswordChangedAt, FailedLoginAttempts, LockoutEndsAt, LastLoginAt\n\n**API Endpoints:**\n- POST /auth/register - public\n- POST /auth/login - public  \n- POST /auth/refresh - public\n- POST /auth/logout - authenticated\n- GET /auth/me - authenticated\n- POST /auth/api-keys - authenticated\n- GET /auth/api-keys - authenticated\n- DELETE /auth/api-keys/{id} - authenticated\n\n**Security Features:**\n- PBKDF2 (100k iterations) for passwords\n- SHA256 for API keys\n- Refresh token rotation\n- Account lockout (5 attempts = 15min)\n- 15min JWT, 7-day refresh tokens\n\n**NuGet packages needed:**\n- Microsoft.IdentityModel.Tokens\n- System.IdentityModel.Tokens.Jwt\n- Microsoft.AspNetCore.Authentication.JwtBearer","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-18T16:38:07.988974363-05:00","created_by":"wanerpena","updated_at":"2026-01-18T17:01:47.338411828-05:00","closed_at":"2026-01-18T17:01:47.338411828-05:00","close_reason":"JWT + API Key authentication implementation complete. All phases implemented: Domain layer entities/DTOs, Engines for JWT/Password/ApiKey operations, Accessors for RefreshToken/ApiKey storage, AuthManager for business logic, Clients.Api handlers and AuthController, configuration, and database migration. Tested successfully: registration, login, JWT auth, API key creation, API key auth."}
{"id":"voiceprocessor-api-hpa","title":"Create Accessor interfaces","description":"Define Accessor layer interfaces: IUserAccessor, IVoiceAccessor, IGenerationAccessor, IGenerationChunkAccessor (database), ITtsProviderAccessor (TTS APIs), IStorageAccessor (blob storage).","notes":"Completed: Interfaces in Accessors/Contracts/. These were implemented in voiceprocessor-api-33n.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T13:47:17.310714765-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:26:27.722968157-05:00","closed_at":"2026-01-18T13:48:45.354893996-05:00","close_reason":"Accessor interfaces created for database, TTS providers, and storage"}
{"id":"voiceprocessor-api-kbl","title":"Create PaymentsController","description":"Create PaymentsController with endpoints: GET /api/v1/payments/packs (public, cached), POST /api/v1/payments/checkout (auth required), GET /api/v1/payments/history (auth required).","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:59.667323034-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:07:15.15593289-05:00","closed_at":"2026-01-23T23:07:15.15593289-05:00","close_reason":"Created PaymentsController with GET /packs (public), POST /checkout (auth), GET /history (auth) endpoints"}
{"id":"voiceprocessor-api-l2i","title":"Add A/B testing for voice preset optimization","description":"Track which voice presets produce the best user satisfaction to optimize parameter values over time.\n\n**Goal:**\nValidate and optimize the research-based preset values using real user feedback.\n\n**Implementation Ideas:**\n1. Generate 2 versions with slightly different settings\n2. Let user pick preferred version\n3. Track: preset used + rating given\n4. Analyze: which parameter values correlate with higher ratings\n\n**Data to Collect:**\n- Preset selected\n- User rating (1-5 or thumbs up/down)\n- Content length\n- Provider used\n\n**Analysis:**\n- Correlate ratings with preset choice\n- Identify if certain content lengths prefer different settings\n- A/B test parameter variations within presets\n\n**Depends on:**\n- voiceprocessor-api-7zu (voice presets feature)\n- voiceprocessor-api-1mm (feedback accessor)\n\n**Target Phase:** Beta (Mar 2026)","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-24T19:25:27.820564082-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:25:27.820564082-05:00","dependencies":[{"issue_id":"voiceprocessor-api-l2i","depends_on_id":"voiceprocessor-api-7zu","type":"blocks","created_at":"2026-01-24T19:25:33.162682831-05:00","created_by":"wanerpena"},{"issue_id":"voiceprocessor-api-l2i","depends_on_id":"voiceprocessor-api-1mm","type":"blocks","created_at":"2026-01-24T19:25:33.205908984-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-nrc","title":"Set up Railway deployment for backend API","description":"Configure Railway for .NET backend deployment. Includes: Railway project setup, PostgreSQL database provisioning, environment variables configuration, CI/CD from GitHub, custom domain setup. Target: production-ready for thousands of users.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:11:21.87598514-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:11:21.87598514-05:00"}
{"id":"voiceprocessor-api-oev","title":"Update UserAccessor with AddCreditsAsync","description":"Add AddCreditsAsync method to IUserAccessor and UserAccessor. Must be atomic: UPDATE users SET credits_remaining = credits_remaining + @amount WHERE id = @userId.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:57.913871918-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:04:01.390004915-05:00","closed_at":"2026-01-23T23:04:01.390004915-05:00","close_reason":"Added AddCreditsAsync method to IUserAccessor interface and UserAccessor implementation using atomic ExecuteUpdateAsync"}
{"id":"voiceprocessor-api-pyc","title":"Create .NET solution structure with iDesign layers","description":"Create .NET 10 solution with iDesign architecture layers: Clients.Api, Managers, Engines, Accessors, Utilities, Domain. Set up project references following iDesign calling rules (top-to-bottom only).","notes":"Completed: Solution structure with numbered solution folders for IDE organization. All project references configured.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-17T22:52:57.386723075-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:25:49.128814835-05:00","closed_at":"2026-01-17T23:02:18.858156491-05:00","close_reason":"Solution structure created with iDesign layers"}
{"id":"voiceprocessor-api-rq2","title":"Implement PaymentManager","description":"Create IPaymentManager interface and PaymentManager. Methods: CreateCheckoutAsync (validate + create session), HandleWebhookAsync (idempotent credit addition), GetPaymentHistoryAsync.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:58.828265612-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:06:30.176218502-05:00","closed_at":"2026-01-23T23:06:30.176218502-05:00","close_reason":"Created IPaymentManager interface and PaymentManager implementation with GetCreditPacksAsync, CreateCheckoutAsync, HandleWebhookAsync, GetPaymentHistoryAsync. Includes idempotent webhook handling."}
{"id":"voiceprocessor-api-tkn","title":"Integrate Sentry for error tracking and APM","description":"Add Sentry SDK to both backend (.NET) and frontend (React). Covers: exception tracking with stack traces, performance monitoring/APM, user context for errors, release tracking, source maps for frontend, alerts configuration.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:11:29.071630216-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:11:29.071630216-05:00"}
{"id":"voiceprocessor-api-ulv","title":"Create API DTOs","description":"Create request DTOs (CreateGenerationRequest, EstimateCostRequest, SubmitFeedbackRequest) and response DTOs (GenerationResponse, CostEstimateResponse, VoiceResponse, ErrorResponse, PagedResponse\u003cT\u003e).","notes":"Completed: DTOs in Domain/DTOs/Requests/ and Domain/DTOs/Responses/. Using records with required properties.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-18T12:34:38.311140916-05:00","created_by":"wanerpena","updated_at":"2026-01-18T14:26:07.562351283-05:00","closed_at":"2026-01-18T12:37:24.73528129-05:00","close_reason":"Created request/response DTOs for API"}
{"id":"voiceprocessor-api-upe","title":"Implement Hangfire for background job processing","description":"Set up Hangfire for async TTS generation. Includes: Hangfire NuGet packages, PostgreSQL storage configuration, dashboard setup, job queue for generation processing. This unblocks the actual TTS workflow - currently CreateGenerationAsync has TODO at line 193.","notes":"Include scheduled voice catalog refresh job (daily/weekly) using RecurringJob.AddOrUpdate to sync new voices from providers.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-19T17:15:20.668868723-05:00","created_by":"wanerpena","updated_at":"2026-01-19T21:00:21.268105129-05:00","closed_at":"2026-01-19T21:00:21.268105129-05:00","close_reason":"Implemented Hangfire for background job processing with GenerationProcessor and scheduled voice refresh"}
{"id":"voiceprocessor-api-vlz","title":"Register Stripe services in DI","description":"Update ServiceCollectionExtensions in Accessors and Managers. Add Stripe.net NuGet package. Configure IMemoryCache for product caching.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-23T22:57:01.606279256-05:00","created_by":"wanerpena","updated_at":"2026-01-23T23:05:11.635320793-05:00","closed_at":"2026-01-23T23:05:11.635320793-05:00","close_reason":"Registered PaymentHistoryAccessor, StripeAccessor, StripeOptions in DI. Added AddMemoryCache for caching support."}
{"id":"voiceprocessor-api-xze","title":"Set up Cloudflare Pages for frontend deployment","description":"Configure Cloudflare Pages for React/Next.js frontend. Includes: Cloudflare project setup, build settings, environment variables, CI/CD from GitHub, custom domain and SSL. Benefits: unlimited bandwidth, global CDN, free tier.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:11:24.52633091-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:11:24.52633091-05:00"}
{"id":"voiceprocessor-api-yot","title":"Create PaymentHistory entity and migration","description":"Add PaymentHistory entity to Domain layer. Fields: Id, UserId, StripeSessionId, Amount, Currency, CreditsAdded, PackId, CreatedAt. Configure in DbContext and create EF migration.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-23T22:56:53.848913247-05:00","created_by":"wanerpena","updated_at":"2026-01-23T22:59:46.635357591-05:00","closed_at":"2026-01-23T22:59:46.635357591-05:00","close_reason":"Created PaymentHistory entity with all fields, added navigation property to User, configured in DbContext with proper indexes, created EF migration"}
{"id":"voiceprocessor-api-yqy","title":"Add text input character limits and validation","description":"Frontend textarea for manual text input needs character limits and UX guidance.\n\n**Limits Decided:**\n- Hard max: 500,000 characters (full novel)\n- Soft warning at 50,000: Suggest document upload\n- Cost warning at 100,000: Show estimated credits\n\n**UI Requirements:**\n- Live character counter: '45,230 / 500,000 characters'\n- Estimated cost display: '≈ 45,230 credits'\n- Warning message at 50K suggesting document upload\n- Block submission at 500K with error message\n\n**API Consideration:**\n- Optional: Add MaxLength validation to CreateGenerationRequest.Text (backend)\n\n**Business Context:**\n- Aligns with credit packs (15K-120K)\n- Supports full novel use case (~500K chars)\n- Encourages document upload for large content (deferred to Beta: voiceprocessor-api-7qe)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-24T18:58:05.226361343-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:07:07.646288774-05:00","closed_at":"2026-01-24T19:07:07.646288774-05:00","close_reason":"Moved to voiceprocessor-web repository - this is primarily frontend work"}
{"id":"voiceprocessor-api-ytz","title":"Implement payment success/cancel callback pages","description":"## Frontend: Payment Success/Cancel Callback Pages\n\nCreate pages to handle Stripe checkout callbacks after payment completes or is cancelled.\n\n### URLs to Implement\n- `/payment/success` - Shown after successful payment\n- `/payment/cancel` - Shown if user cancels checkout\n\n### Success Page Requirements\n1. Display 'Payment Successful' confirmation\n2. Show purchased pack details (name, credits added)\n3. Refresh user credits from API\n4. 'Go to Dashboard' button\n5. Optional: Confetti animation\n\n### Cancel Page Requirements\n1. Display 'Payment Cancelled' message\n2. 'Try Again' button → returns to billing\n3. 'Contact Support' link\n\n### Technical Notes\n- Success URL receives `session_id` query param from Stripe\n- Can optionally verify session status via backend\n- Credits already added by webhook before redirect\n\n### Acceptance Criteria\n- [ ] /payment/success route created\n- [ ] /payment/cancel route created\n- [ ] Success page refreshes credits\n- [ ] Cancel page offers retry option\n- [ ] Both pages are responsive","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-24T19:55:46.270000954-05:00","created_by":"wanerpena","updated_at":"2026-01-24T19:56:09.720617652-05:00","dependencies":[{"issue_id":"voiceprocessor-api-ytz","depends_on_id":"voiceprocessor-api-9bv","type":"blocks","created_at":"2026-01-24T19:56:35.343540714-05:00","created_by":"wanerpena"}]}
{"id":"voiceprocessor-api-z3f","title":"Implement API rate limiting","description":"Add rate limiting to protect API. Includes: AspNetCoreRateLimit package, per-user and per-IP limits, different limits by subscription tier, 429 responses with retry-after header. Prevents abuse and ensures fair usage.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-19T17:15:44.520754947-05:00","created_by":"wanerpena","updated_at":"2026-01-19T17:15:44.520754947-05:00"}
